{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tourism Website</title>
    <link rel="stylesheet" href="{% static 'styles.css' %}">
    <!-- Подключение API Яндекс.Карт -->
    <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&amp;apikey= 3de6dadd-fc06-41d7-95b4-cf36885813d9 " type="text/javascript"></script>
    <style>
        #map {
            width: 100%;
            height: 300px; /* Высота карты, которую можно адаптировать под дизайн */
            margin-bottom: 20px;
        }

        .map-container {
            width: 100%;
            max-width: 400px; /* Максимальная ширина контейнера для карты */
            margin: 0 auto; /* Центрирование контейнера по горизонтали */
            border: 1px solid #ccc; /* Граница для контейнера карты */
            border-radius: 8px;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <h1>Welcome to Your Tourism Website</h1>
            <p>Explore, Discover, Enjoy</p>
        </div>
    </header>

    <main class="main">
        <section class="attractions-section">
            <div class="container">
                <h2>Explore Attractions</h2>
                <form method="post" id="routeForm">
                    {% csrf_token %}
                    <label for="start_point">Select a Starting Point:</label>
                    <select name="start_point" id="start_point">
                        {% for attraction in attractions %}
                            <option value="{{ attraction.id }}" {% if selected_start_point == attraction.name %}selected{% endif %}>{{ attraction.name }}</option>
                        {% endfor %}
                    </select>
                    <label for="time_limit">Time Limit (in hours):</label>
                    <input type="number" id="time_limit" name="time_limit" min="1" value="1" step="0.1">
                    <button type="button" onclick="planRoute()">Plan Route</button>
                </form>
            </div>
        </section>

        {% if route %}
        <section class="route-section">
            <div class="container">
                <h2>Your Planned Route</h2>
                <p>Starting from: <strong>{{ selected_start_point }}</strong></p>
                <p>Total Time: {{ total_time|floatformat:1 }} hours</p>
                <p>Total Distance: {{ total_distance|floatformat:1 }} km</p>
                <ul id="route-list">
                    {% for point in route %}
                        <li>{{ point }}</li>
                    {% endfor %}
                </ul>
            </div>
        </section>
        {% endif %}
    </main>

    <!-- Контейнер для карты -->
    <div class="map-container">
        <div id="map"></div>
    </div>

    <!-- JavaScript код для инициализации карты и отображения маркеров -->
    <script>
        function initMap() {
            // Создание экземпляра карты
            var map = new ymaps.Map("map", {
                center: [45.0448, 41.9699], // Координаты центра Ставрополя
                zoom: 12 // Уровень масштабирования карты

            });

            // Добавление маркеров достопримечательностей
            {% for attraction in attractions %}
                var placemark{{ attraction.id }} = new ymaps.Placemark(
                    [{{ attraction.latitude }}, {{ attraction.longitude }}],
                    {
                        hintContent: "{{ attraction.name }}",
                        balloonContent: "{{ attraction.name }}"
                    },
                    {
                        preset: 'islands#blueDotIcon' // Стиль маркера
                    }
                );

                map.geoObjects.add(placemark{{ attraction.id }});
            {% endfor %}
        }

        // Загрузка карты после полной загрузки страницы
        document.addEventListener('DOMContentLoaded', function () {
            ymaps.ready(initMap);
        });

        // Функция для отправки формы с выбором точек маршрута
        function planRoute() {
            var form = document.getElementById('routeForm');
            form.submit();
        }
    </script>
</body>
</html>
